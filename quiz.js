//quiz.js

let selectedQuizData = [];\nlet currentQuestion = 0;\nlet score = 0;\nlet incorrectAnswers = [];\nlet previousAnswers = []; // To store previous answers\n\nfunction shuffleArray(array) {\n  for (let i = array.length - 1; i > 0; i--) {\n    const j = Math.floor(Math.random() * (i + 1));\n    [array[i], array[j]] = [array[j], array[i]];\n  }\n}\n\n// Quiz için benzersiz ID oluştur (soru sayısı ve ilk soruya göre)\nfunction getQuizId() {\n  if (!selectedQuizData || selectedQuizData.length === 0) return null;\n  return `${selectedQuizData.length}_${selectedQuizData[0].question.substring(0, 20)}`;\n}\n\n// İlerlemeyi localStorage'a kaydet\nfunction saveProgress() {\n  const progress = {\n    quizId: getQuizId(),\n    currentQuestion: currentQuestion,\n    score: score,\n    incorrectAnswers: incorrectAnswers,\n    previousAnswers: previousAnswers,\n    timestamp: Date.now()\n  };\n  localStorage.setItem('quizProgress', JSON.stringify(progress));\n}\n\nfunction displayQuestion() {\n  const quizContainer = document.getElementById('quiz');\n  quizContainer.style.display = 'block';\n\n  const questionData = selectedQuizData[currentQuestion];\n  const questionElement = document.createElement('div');\n  questionElement.className = 'question';\n  questionElement.innerHTML = questionData.question;\n\n  const optionsElement = document.createElement('div');\n  optionsElement.className = 'options';\n\n  const shuffledOptions = [...questionData.options];\n  shuffleArray(shuffledOptions);\n\n  for (let i = 0; i < shuffledOptions.length; i++) {\n    const option = document.createElement('label');\n    option.className = 'option';\n\n    const radio = document.createElement('input');\n    radio.type = 'radio';\n    radio.name = 'quiz';\n    radio.value = shuffledOptions[i];\n\n    const optionText = document.createTextNode(shuffledOptions[i]);\n\n    option.appendChild(radio);\n    option.appendChild(optionText);\n    optionsElement.appendChild(option);\n  }\n\n  quizContainer.innerHTML = '';\n  quizContainer.appendChild(questionElement);\n  quizContainer.appendChild(optionsElement);\n\n  // Mark the previous answer\n  if (previousAnswers[currentQuestion]) {\n    const selectedOption = document.querySelector(`input[name="quiz"][value="${previousAnswers[currentQuestion]}"]`);\n    if (selectedOption) {\n      selectedOption.checked = true;\n    }\n  }\n\n  // Update question number\n  const questionNumberElement = document.getElementById('questionNumber');\n  questionNumberElement.innerText = `Question number: ${currentQuestion + 1}/${selectedQuizData.length}`;\n}\n\nfunction startQuiz() {\n  const quizData = JSON.parse(localStorage.getItem('selectedQuizData')); // Questions from selectQuestion.js\n  if (!quizData || quizData.length === 0) {\n    alert('No questions selected for the quiz.');\n    window.location.href = 'selectQuestion.html';\n    return;\n  }\n\n  selectedQuizData = quizData;\n  \n  // Önceki ilerleme varsa kullanıcıya sor\n  const savedProgress = JSON.parse(localStorage.getItem('quizProgress'));\n  if (savedProgress && savedProgress.quizId === getQuizId()) {\n    const resume = confirm(\n      `Quiz'de soru ${savedProgress.currentQuestion + 1}/${selectedQuizData.length}'de kalmıştınız. Devam etmek ister misiniz?\n\n` +\n      `Tamam: Kaldığınız yerden devam edin\nİptal: Yeni başlayın`\n    );\n    \n    if (resume) {\n      // Kaldığı yerden devam et\n      currentQuestion = savedProgress.currentQuestion || 0;\n      score = savedProgress.score || 0;\n      incorrectAnswers = savedProgress.incorrectAnswers || [];\n      previousAnswers = savedProgress.previousAnswers || new Array(selectedQuizData.length).fill(null);\n    } else {\n      // Yeni başla\n      localStorage.removeItem('quizProgress');\n      currentQuestion = 0;\n      score = 0;\n      incorrectAnswers = [];\n      previousAnswers = new Array(selectedQuizData.length).fill(null);\n    }\n  } else {\n    // İlk kez başlatılıyor\n    currentQuestion = 0;\n    score = 0;\n    incorrectAnswers = [];\n    previousAnswers = new Array(selectedQuizData.length).fill(null);\n  }\n\n  document.getElementById('submit').style.display = 'inline-block';\n  document.getElementById('previous').style.display = 'inline-block';\n  displayQuestion();\n}\n\nfunction checkAnswer() {\n  const selectedOption = document.querySelector('input[name="quiz"]:checked');\n  if (selectedOption) {\n    const answer = selectedOption.value;\n    previousAnswers[currentQuestion] = answer; // Store the answer\n    if (answer === selectedQuizData[currentQuestion].answer) {\n      score++;\n    } else {\n      incorrectAnswers.push({\n        question: selectedQuizData[currentQuestion].question,\n        incorrectAnswer: answer,\n        correctAnswer: selectedQuizData[currentQuestion].answer,\n      });\n    }\n    currentQuestion++;\n    \n    // İlerlemeyi kaydet\n    saveProgress();\n    \n    if (currentQuestion < selectedQuizData.length) {\n      displayQuestion();\n    } else {\n      displayResult();\n      // Quiz tamamlandığında ilerlemeyi temizle\n      localStorage.removeItem('quizProgress');\n    }\n  }\n}\n\nfunction showPreviousQuestion() {\n  if (currentQuestion > 0) {\n    currentQuestion--;\n    saveProgress(); // Geri giderken de kaydet\n    displayQuestion();\n  }\n}\n\nfunction displayResult() {\n  const quizContainer = document.getElementById('quiz');\n  const resultContainer = document.getElementById('result');\n  quizContainer.style.display = 'none';\n  document.getElementById('submit').style.display = 'none';\n  document.getElementById('previous').style.display = 'none';\n  resultContainer.innerHTML = `You scored ${score} out of ${selectedQuizData.length}!`;\n\n  // Make "Show Answer" and "Exit" buttons visible and active\n  document.getElementById('showAnswer').classList.remove('hide');\n  document.getElementById('exit').classList.remove('hide');\n  document.getElementById('selectQuestionPage').classList.remove('hide');\n}\n\nfunction showAnswers() {\n  const incorrectAnswersContainer = document.getElementById('incorrectAnswers');\n  incorrectAnswersContainer.innerHTML = '<h2>Incorrect Answers:</h2>';\n  incorrectAnswersContainer.style.overflowY = 'auto';\n  incorrectAnswersContainer.style.maxHeight = '500px';\n  incorrectAnswers.forEach(answer => {\n    const answerElement = document.createElement('div');\n    answerElement.innerHTML = `\n      <p><strong>Question:</strong> ${answer.question}</p>\n      <p><strong>Given Answer:</strong> ${answer.incorrectAnswer}</p>\n      <p><strong>Correct Answer:</strong> ${answer.correctAnswer}</p>\n      <hr>\n    `;\n    incorrectAnswersContainer.appendChild(answerElement);\n  });\n  incorrectAnswersContainer.classList.remove('hide');\n}\n\nfunction exitQuiz() {\n  window.location.href = 'index.html';\n}\nfunction goSelectQuestionPage() {\n  window.location.href = 'selectQuestion.html';\n}\ndocument.getElementById('submit').addEventListener('click', checkAnswer);\ndocument.getElementById('previous').addEventListener('click', showPreviousQuestion);\ndocument.getElementById('showAnswer').addEventListener('click', showAnswers);\ndocument.getElementById('exit').addEventListener('click', exitQuiz);\ndocument.getElementById('selectQuestionPage').addEventListener('click', goSelectQuestionPage);\n// Close the window\ndocument.getElementById('closeButton').addEventListener('click', () => {\n  window.location.href = 'index.html';\n});\nstartQuiz(); // Start the quiz\n